<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>GEOG0014</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03-worksheet.html" rel="next">
<link href="./01-data-prep.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


<link rel="stylesheet" href="assets/styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01-data-prep.html">Crime in London</a></li><li class="breadcrumb-item"><a href="./02-map-crime.html">Data mapping</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./assets/logo.svg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/jtvandijk/GEOG0014" rel="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
    <div id="quarto-search" class="quarto-navigation-tool px-1" title="Search"></div>
</div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Welcome</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mapping London</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Crime in London</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-data-prep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1 Data preparation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-map-crime.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">2 Data mapping</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-worksheet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3 Worksheet</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#data-mapping" id="toc-data-mapping" class="nav-link active" data-scroll-target="#data-mapping"><span class="header-section-number">1</span> Data mapping</a>
  <ul class="collapse">
  <li><a href="#starting-qgis" id="toc-starting-qgis" class="nav-link" data-scroll-target="#starting-qgis"><span class="header-section-number">1.1</span> Starting QGIS</a></li>
  <li><a href="#loading-spatial-data" id="toc-loading-spatial-data" class="nav-link" data-scroll-target="#loading-spatial-data"><span class="header-section-number">1.2</span> Loading spatial data</a></li>
  <li><a href="#organising-our-layers" id="toc-organising-our-layers" class="nav-link" data-scroll-target="#organising-our-layers"><span class="header-section-number">1.3</span> Organising our layers</a></li>
  <li><a href="#inspecting-our-data-in-excel" id="toc-inspecting-our-data-in-excel" class="nav-link" data-scroll-target="#inspecting-our-data-in-excel"><span class="header-section-number">1.4</span> Inspecting our data in Excel</a></li>
  <li><a href="#loading-our-data-into-qgis" id="toc-loading-our-data-into-qgis" class="nav-link" data-scroll-target="#loading-our-data-into-qgis"><span class="header-section-number">1.5</span> Loading our data into QGIS</a></li>
  <li><a href="#making-selections" id="toc-making-selections" class="nav-link" data-scroll-target="#making-selections"><span class="header-section-number">1.6</span> Making selections</a></li>
  <li><a href="#visualising-data" id="toc-visualising-data" class="nav-link" data-scroll-target="#visualising-data"><span class="header-section-number">1.7</span> Visualising data</a></li>
  <li><a href="#creating-a-map" id="toc-creating-a-map" class="nav-link" data-scroll-target="#creating-a-map"><span class="header-section-number">1.8</span> Creating a map</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/jtvandijk/GEOG0014/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="data-mapping" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Data mapping</h1>
<section id="starting-qgis" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="starting-qgis"><span class="header-section-number">1.1</span> Starting QGIS</h2>
<p>Now we have downloaded and organised our data, we can open <a href="https://www.qgis.org/en/site/">QGIS</a>. QGIS is a free and open-source cross-platform desktop geographic information system application that supports viewing, editing, and analysis of geospatial data. In the search box of the task bar, type in QGIS and click on <strong>QGIS Desktop 3.28</strong> to open the software.</p>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Do not use QGIS 2.18 as the steps in this tutorial will not work!</p>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-open-qgis" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/open_qgis.png" class="img-fluid figure-img" width="1552"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Open <strong>QGIS Desktop 3.28</strong>. <a href="https://jtvandijk.github.io/GEOG0014/images/open_qgis.png" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
<p>It may take a little while before QGIS has started, so be patient. In some cases Desktop@UCL Anywhere fails to start QGIS on the first attempt, you may have to give it several attempts. Once QGIS has started, you will see the QGIS interface:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-interface-qgis" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/interface.png" class="img-fluid figure-img" width="1552"></p>
<figcaption class="figure-caption">Figure&nbsp;2: The QGIS interface. <a href="https://jtvandijk.github.io/GEOG0014/images/interface.png" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
<p>On the left hand sizes you see two panels: <strong>Layers</strong> and <strong>Browser</strong>. We do not really need the second one, so you can close it by clicking on the <code>x</code>.</p>
</section>
<section id="loading-spatial-data" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="loading-spatial-data"><span class="header-section-number">1.2</span> Loading spatial data</h2>
<p>We can now start by adding our spatial data. We will start by adding our <code>roads</code> layer. Click on <strong>Layer</strong> &gt; <strong>Add Layer</strong> &gt; <strong>Add Vector Layer …</strong>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-add-vector" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/add_vector.png" class="img-fluid figure-img" width="1552"></p>
<figcaption class="figure-caption">Figure&nbsp;3: Adding vector data. <a href="https://jtvandijk.github.io/GEOG0014/images/add_vector.png" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
<p>Click on the three dots (<strong>…</strong>) next to the <strong>Vector Dataset(s)</strong> box and navigate to your <em>working directory</em>. Then go into your <code>roads</code> folder and click on the roads file with the <code>SHP File</code> type. This is the roads <code>shapefile</code> that we want.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-add-shp" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/add_shp.png" class="img-fluid figure-img" width="1552"></p>
<figcaption class="figure-caption">Figure&nbsp;4: Loading the roads shapefile. <a href="https://jtvandijk.github.io/GEOG0014/images/add_shp.png" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
<p>Click <strong>Open</strong>. Then click <strong>Add</strong>. If you get a message popping up saying something about “Select Transformations for roads” just click on <strong>OK</strong>. Now <strong>Close</strong> the dialog box. You should now see the road network of Camden and Islington loaded:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-roads-loaded" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/roads_loaded.png" class="img-fluid figure-img" width="1552"></p>
<figcaption class="figure-caption">Figure&nbsp;5: Roads loaded. <a href="https://jtvandijk.github.io/GEOG0014/images/roads_loaded.png" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
<p>Now repeat these steps for our <code>boroughs</code> file, making sure again that inside your <code>boroughs</code> folder you select the boroughs file with the <code>SHP File</code> type. You now will have both data loaded, although the <code>boroughs</code> layer will be drawn on top of your <code>roads</code> layer.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>QGIS randomly picks a colour when a map layer is first loaded, so the colours of your <code>roads</code> and <code>boroughs</code> file may be different than the ones shown in the screenshots.</p>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-bor-loaded" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/bor_loaded.png" class="img-fluid figure-img" width="1552"></p>
<figcaption class="figure-caption">Figure&nbsp;6: Boroughs loaded. <a href="https://jtvandijk.github.io/GEOG0014/images/bor_loaded.png" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="organising-our-layers" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="organising-our-layers"><span class="header-section-number">1.3</span> Organising our layers</h2>
<p>Now we have our first set of data loaded, we can reorganise them a little. In the <strong>Layers</strong> panel, we can drag the <code>roads</code> layer on top of the <code>boroughs</code> layer to change the drawing order. We can also zoom to a layer’s full extent (right click on <code>roads</code> or <code>boroughs</code> &gt; <strong>Zoom to Layer</strong>), change a layer’s colour (right click on <code>roads</code> or <code>boroughs</code> &gt; <strong>Properties …</strong> &gt; change the colour under the <strong>Symbology</strong> tab), and zoom in and out of the map by scrolling:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-organise-data" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/organise_data.gif" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;7: Organising the order of our data.. <a href="https://jtvandijk.github.io/GEOG0014/images/organise_data.gif" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
<p>Before doing anything else, now would be a good time to save our QGIS project. Go to <strong>Project</strong> &gt; <strong>Save as</strong> and save your file in your <em>working directory</em> as <code>crime_map</code>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-save-project" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/save_project.png" class="img-fluid figure-img" width="1552"></p>
<figcaption class="figure-caption">Figure&nbsp;8: Saving your QGIS project. <a href="https://jtvandijk.github.io/GEOG0014/images/save_project.png" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="inspecting-our-data-in-excel" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="inspecting-our-data-in-excel"><span class="header-section-number">1.4</span> Inspecting our data in Excel</h2>
<p>The next thing we want to do is have a closer look at the crime data that we downloaded before loading them too in QGIS.</p>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The crime file that we downloaded is in a so-called <code>csv</code> format. <code>csv</code> stands for comma (or character) separated values. A <code>csv</code> file can be thought of as stripped down Excel spreadsheet in which every column of data is separated by a comma. If you open a <code>csv</code> file within Excel, however, it will look “normal”.</p>
</div>
</div>
</div>
<p>Navigate to your <code>working directory</code> and go to <code>crime_met_november2021</code> &gt; <code>2021_11</code>. Now open the <code>2011-11-metropolitan-street</code> file using Excel.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-inspect-data" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/inspect_data.gif" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;9: Inspecting our crime data <code>csv</code>. <a href="https://jtvandijk.github.io/GEOG0014/images/inspect_data.gif" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
<p>Besides a column containing a unique <code>Crime ID</code> as well as the <code>Month</code> in which the crime has been recorded, our crime data set contains several other columns of data:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">Column</th>
<th style="text-align: left;">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>Reported by</code></td>
<td style="text-align: left;">The force that provided the data about the crime.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>Falls within</code></td>
<td style="text-align: left;">The area in which the crime was recorded.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>Longitude and Latitude</code></td>
<td style="text-align: left;">The anonymised coordinates of the location of the crime.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>LSOA code and LSOA name</code></td>
<td style="text-align: left;">References to the <a href="https://statistics.ukdataservice.ac.uk/dataset/2011-census-geography-boundaries-lower-layer-super-output-areas-and-data-zones">Lower Layer Super Output Area</a> that the anonymised point falls into, according to the LSOA boundaries provided by the Office for National Statistics.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>Crime type</code></td>
<td style="text-align: left;">One of the crime types used to categorise the offence.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>Last outcome category</code></td>
<td style="text-align: left;">A reference to whichever of the outcomes associated with the crime occurred most recently.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>Context</code></td>
<td style="text-align: left;">A field provided for forces to provide additional human-readable data about individual crimes.</td>
</tr>
</tbody>
</table>
<p>For us, the main fields we are interested include <code>Longitude</code> and <code>Latitude</code> (for plotting the crimes in QGIS) as well as <code>Crime Type</code> (to filter crime based on type of crime). After inspecting the data, you can close Excel again. Make sure that you do <strong>not</strong> save the file.</p>
</section>
<section id="loading-our-data-into-qgis" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="loading-our-data-into-qgis"><span class="header-section-number">1.5</span> Loading our data into QGIS</h2>
<p>Now we know what we are dealing with, we can load our crime data into QGIS. To do so, there are several steps we need to take:</p>
<ul>
<li>Go to <strong>Layer</strong> &gt; <strong>Add Layer</strong> &gt; <strong>Add Delimited Text Layer …</strong>. Because our data is a <code>csv</code> file we need to load it as a file in which columns are delimited by a certain character; a comma in our case.</li>
<li>Click on the three dots (<em>…</em>) next to the <strong>File name</strong> box and navigate to your <em>working directory</em>. Then go into your <code>crime_met_november2021</code> folder, your <code>2021-11</code> folder, and <strong>Open</strong> the <code>2021-11-metropolitan-street</code> file.</li>
<li>Under <strong>Geometry Definitions</strong> make sure that <strong>X field</strong> is set to <code>Longitude</code> and <strong>Y field</strong> is set to <code>Latitude</code>. Here we inform QGIS that we are dealing with locations.</li>
<li>Without going into further details, we need to tell QGIS which <a href="https://en.wikipedia.org/wiki/Map_projection">map projection</a> was used to record the crime locations. By specifying a <a href="https://en.wikipedia.org/wiki/Map_projection">map projection</a> QGIS will know how to plot the crime locations in their correct positions. To do so, still under the <strong>Geometry Definitions</strong> tab, click on the <strong>Select CRS</strong> button. You will find this is directly next to the <em>invalid projection</em> message. In the <strong>Filter</strong> box type: <code>EPSG 4326</code>. Only one option should show up: <code>WGS 84</code>. Select this option and click <strong>OK</strong>.</li>
<li>Now click <strong>Add</strong>. <em>This may take a little bit of time!</em> Click <strong>Close</strong> to exit the dialog box.</li>
</ul>
<p>The <strong>GIF</strong> below summarises these steps:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-load-crime-data" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/load_crime_data.gif" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;10: Loading our crime data into QGIS. <a href="https://jtvandijk.github.io/GEOG0014/images/load_crime_data.gif" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
<p>Here we now have every crime reported for the month November 2021 appearing across all of London. We can zoom to the Camden and Islington by right clicking on the <code>roads</code> layer and opting for <strong>Zoom to Layer</strong>:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-crime-ci" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/crime_ci.png" class="img-fluid figure-img" width="1552"></p>
<figcaption class="figure-caption">Figure&nbsp;11: All crime that is recorded in Camden and Islington in November 2021. <a href="https://jtvandijk.github.io/GEOG0014/images/crime_ci.png" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="making-selections" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="making-selections"><span class="header-section-number">1.6</span> Making selections</h2>
<p>Because the crime data set covers the whole of London, and even records some crimes in locations outside of London, QGIS may get a little slow. As we are only interested in crimes in Camden and Islington we want to filter out only those crimes that took place within the boundaries of these boroughs, and remove the rest. We will do that in two steps. First, we will export the boundaries of Camden and Islington as a separate file. Second, we will select the crimes that fall within the boundaries of Camden and Islington. Let’s first export the boundaries of Camden and Islington:</p>
<ul>
<li>Untick the boxes of the <code>roads</code> and <code>2021-11-metropolitan-street</code> layers in the <strong>Layers</strong> panel to deactivate them.</li>
<li>Select the <code>boroughs</code> layer by clicking on it.</li>
<li>Click on the <strong>Select Features by Area or Single Click</strong> button: <br><br></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/select.png" class="img-fluid figure-img" width="50"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The <strong>Select Features by Area or Single Click</strong> button may be found at a different position in the menu than shown in the <strong>GIF</strong> below.</p>
</div>
</div>
</div>
<ul>
<li>Press and hold the <strong>Shift</strong> button on your keyboard and click on Camden and Islington.</li>
<li>Right click on the <code>boroughs</code> layer in the <strong>Layers</strong> panel &gt; <strong>Export</strong> &gt; <strong>Save Selected Features As …</strong>.</li>
<li>Set the <strong>Format</strong> to <strong>Esri Shapefile</strong>.</li>
<li>Click on the three dots (<strong>…</strong>) next to <strong>File name</strong>, navigate to your <em>working directory</em> and <strong>Save</strong> the file as <code>cam_is</code>.</li>
<li>A new layer should now appear and you can untick the box next to the <code>boroughs</code> layer.</li>
</ul>
<p>The <strong>GIF</strong> below summarises these steps:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-select-boroughs" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/select_export.gif" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;12: Selecting and exporting the boroughs of Camden and Islington. <a href="https://jtvandijk.github.io/GEOG0014/images/select_export.gif" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
<p>The next thing to do is to extract only those crimes that fall within the boundaries of our newly created <code>shapefile</code>:</p>
<ul>
<li>Go to <strong>Vector</strong> &gt; <strong>Geoprocessing Tools</strong> &gt; <strong>Clip …</strong>.</li>
<li>Set <code>2011-11-metropolitan-street</code> as <strong>Input layer</strong> and set <code>cam_is</code> as <strong>Overlay layer</strong>.</li>
<li>Click on the three dots (<strong>…</strong>) next to the empty box with <em>[Create temporary layer]</em> and opt for <strong>Save to File …</strong>. Navigate to your <em>working directory</em> and type in <code>cam_is_clip</code> as <strong>File name</strong>. Change <strong>Save as type</strong> to <code>SHP files (*.shp)</code> and click <strong>Save</strong>.</li>
<li>Click <strong>Run</strong>. <em>This may take a few seconds.</em> Once the process is done, you can click <strong>Close</strong>.</li>
</ul>
<p>We now have successfully ‘clipped’ the crimes that occurred within the boundaries of Camden and Islington. The <strong>GIF</strong> below summarises these steps:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-select-crimes" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/select_crime.gif" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;13: Selecting and exporting the crimes that fall within the boroughs of Camden and Islington. <a href="https://jtvandijk.github.io/GEOG0014/images/select_crime.gif" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
<p>Before moving to our visualisation, we can remove the <code>2011-11-metropolitan-street</code> layer by right clicking on the <code>layer</code> in the <strong>Layers</strong> panel and opting for <strong>Remove Layer…</strong>. We can do the same for the <code>boroughs</code> layer. Our QGIS screen should now look something like this:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ready-4-vis" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/ready_vis.png" class="img-fluid figure-img" width="1552"></p>
<figcaption class="figure-caption">Figure&nbsp;14: We are now ready to visualise our data. <a href="https://jtvandijk.github.io/GEOG0014/images/ready_vis.png" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Do not forget to save your progress once a while!</p>
</div>
</div>
</div>
</section>
<section id="visualising-data" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="visualising-data"><span class="header-section-number">1.7</span> Visualising data</h2>
<p>Based on the shapes of the streets and the outline of the street network, you may be able to recognise some streets already. However, we can also add something called a <em>base map</em> layer. A base map is a layer with geographic information that serves as a background and is incredibly useful when you want to add some context to your map. We do need a little plugin to add this base map. We can do that as follows:</p>
<ul>
<li>Go to <strong>Plugins</strong> &gt; <strong>Manage and Install Plugins</strong>.</li>
<li>Search for <strong>QuickMapServices</strong> and click on <strong>Install plugin</strong>.</li>
<li>Once the plugin is installed you can go to <strong>Web</strong> &gt; <strong>QuickMapServices</strong> &gt; <strong>OSM</strong> &gt; <strong>OSM Standard</strong>. It may take a few seconds to load the base map.</li>
<li>Turn off the Camden and Islington map layer (<code>cam_is</code>) in the <strong>Layers</strong> panel by unticking it.</li>
</ul>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>OSM stands for <a href="https://www.openstreetmap.org/#map=6/54.910/-3.432">OpenStreetMap</a>. OpenStreetMap is a collaborative project to create a free editable geographic database of the world, comparable to Wikipedia but then for spatial information.</p>
</div>
</div>
</div>
<p>You now have a view of the street data, pulled from OpenStreetMap, with the crime data drawn on top. The <strong>GIF</strong> below summarises these steps:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-adding-basemap" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/add_basemap.gif" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;15: Adding a basemap layer. <a href="https://jtvandijk.github.io/GEOG0014/images/add_basemap.gif" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
<p>The next thing we want to do is get some more insight into our crimes. As we know: the data records crime by type, so let’s use this information in our visualisation:</p>
<ul>
<li>Right click on the <code>cam_is_clip</code> layer in the <strong>Layers</strong> panel and click on <strong>Properties …</strong>. Here we can change the symbology of the layer.</li>
<li>At the top of the menu change <strong>Single Symbol</strong> to <strong>Categorized</strong>.</li>
<li>Click on the <strong>Value</strong> drop-down menu and select <code>Crime type</code>. <em>Note that these are the columns that we have seen when we looked at the data in Excel.</em></li>
<li>At the bottom of the menu click on <strong>Classify</strong>. All the different crime types now appear, with each their own symbol. Click <strong>Apply</strong> andExpression click <strong>OK</strong>.</li>
</ul>
<p>The QGIS screen now shows a colour for each crime type. The <strong>GIF</strong> below summarises these steps:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-colour-crimes" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/colour_crime.gif" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;16: Differentiating crime types. <a href="https://jtvandijk.github.io/GEOG0014/images/colour_crime.gif" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
<p>In the <strong>Layers</strong> panel, you can now expand the <code>cam_is_clip</code> layer and switch on and off individual crime types by ticking or unticking their respective boxes:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-one-crime" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/one_crime.png" class="img-fluid figure-img" width="1552"></p>
<figcaption class="figure-caption">Figure&nbsp;17: Only crime classified as <em>anti-social behaviour</em> is shown. <a href="https://jtvandijk.github.io/GEOG0014/images/one_crime.png" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
<p>In addition, we can create a <strong>hotspot</strong> or <strong>heatmap</strong>. QGIS can do this automatically by mapping the density of the points:</p>
<ul>
<li>Right click on the <code>cam_is_clip</code> layer in the <strong>Layers</strong> panel and click on <strong>Properties …</strong>. Here we can change the symbology of the layer.</li>
<li>At the top of the menu change <strong>Single Symbol</strong> to <strong>Heatmap</strong>.</li>
<li>Using the drop-down menu, change the <strong>Color ramp</strong> to <strong>Magma</strong> for a little more exciting map.</li>
<li>Under <strong>Layer Rendering</strong> set the <strong>Opacity</strong> to 60%, so to blend the heatmap with the OSM basemap. Click <strong>Apply</strong>. <em>This may take a few seconds.</em> Then click <strong>OK</strong>.</li>
</ul>
<p>We now have created a rather nice visualisation of all crime in Camden and Islington. The <strong>GIF</strong> below summarises these steps:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-hot-crime" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/hot_crime.gif" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;18: Adding a basemap layer. <a href="https://jtvandijk.github.io/GEOG0014/images/hot_crime.gif" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The resulting map is relatively dark. For your <a href="worksheet.html">worksheet assignment</a> you may want to select a different colour ramp or you may try to edit the <strong>Magma</strong> colour ramp by setting the first colour of the <strong>Color ramp</strong> transparent: instead of changing the <strong>Color ramp</strong> to <strong>Magma</strong>, select the <strong>Edit Color Ramp …</strong> option. Here you can set <strong>Color 1</strong> to <strong>Transparent</strong>. You can also adjust the colours by playing around with the <strong>Gradient Stops</strong> in the same menu. Once you are happy with the changes you have made to the colour palette click <strong>OK</strong>. Then click <strong>Apply</strong> followed by <strong>OK</strong> to exit the menu.</p>
</div>
</div>
</div>
<p>But what if we only want to create a density map only for a given crime type such as <em>anti-social behaviour</em>? We can do that as follows:</p>
<ul>
<li>Right click on the <code>cam_is_clip</code> layer in the <strong>Layers</strong> panel and click on <strong>Open Attribute Table</strong>.</li>
<li>In the <strong>Attribute Table</strong> click on the button that says <strong>Select Features Using Expression</strong>: <br><br></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/select_exp.png" class="img-fluid figure-img" width="30"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Double click on <code>Crime type</code> in the <strong>Fields and Values</strong> drop-down menu. The <code>crime type</code> variable now gets added to the <strong>Expression</strong>.</li>
<li>Directly next to the <code>"Crime type"</code> part of the expression type <code>=</code>.</li>
<li>Now click on the <strong>All Unique</strong> button to get all unique values that are stored in the <code>crime type</code> variable. Double click on <em>Anti-social behaviour</em> to add this to the expression.</li>
<li>Click on <strong>select Features</strong> and <strong>Close</strong> the dialogue box and the <strong>Attribute Table</strong>. The selected crimes should now show up in yellow.</li>
</ul>
<p>Just as we did before with our two boroughs, we can export our selection to a new <code>shapefile</code>:</p>
<ul>
<li>Right click on the <code>cam_is_clip</code> layer in the <strong>Layers</strong> panel &gt; <strong>Export</strong> &gt; <strong>Save Selected Features As …</strong>.</li>
<li>Set the <strong>Format</strong> to <strong>Esri Shapefile</strong>.</li>
<li>Click on the three dots (<strong>…</strong>) next to <strong>File name</strong>, navigate to your <em>working directory</em> and <strong>Save</strong> the file as <code>cam_is_asb</code>.</li>
<li>A new layer should now appear and you can untick the box next to the <code>cam_is_clip</code> layer.</li>
</ul>
<p>Once you have a new layer, you can update the symbology again to create a <strong>heatmap</strong>. The <strong>GIF</strong> below summarises these steps:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-hot-crime-asb" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/hot_crime_asb.gif" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;19: Selecting all crime recorded as <em>anti-social behaviour</em> and exporting this to a new <code>shapefile</code>. <a href="https://jtvandijk.github.io/GEOG0014/images/hot_crime_asb.gif" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="creating-a-map" class="level2" data-number="1.8">
<h2 data-number="1.8" class="anchored" data-anchor-id="creating-a-map"><span class="header-section-number">1.8</span> Creating a map</h2>
<p>We have been through the key steps that we need to create the map, however, there are some other things we can do. For instance, if we want to put the borough outlines on, we can:</p>
<ul>
<li>Tick the box next to the <code>cam_is</code> layer in the <strong>Layers</strong> panel to switch the layer back on.</li>
<li>Right click on the <code>cam_is</code> layer and choose <strong>Properties</strong>.</li>
<li>Under the <strong>Symbology</strong> tab we can make some adjustments to the <strong>Simple Fill</strong> settings: in this case we can set the <strong>Fill style</strong> to <strong>No brush</strong>. We can also make the outline thicker by increasing the <strong>Stroke width</strong>. Once this is done click <strong>Apply</strong> followed by <strong>OK</strong>.</li>
</ul>
<p>The <strong>GIF</strong> below summarises these steps:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-bor-out" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/bor_out.gif" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;20: Adding borough outlines to the map. <a href="https://jtvandijk.github.io/GEOG0014/images/bor_out.gif" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
<p>In this exercise we have downloaded some data, created a spatial data object by loading the data into QGIS, made selections to our data (i.e.&nbsp;by clipping out our boroughs and by making a selection on crime type), and we have looked at some of the styling options. The final step is to finalise the styling and get the map out of QGIS. This is done through the QGIS <strong>Print Layout</strong>:</p>
<ul>
<li>Go to <strong>Project</strong> &gt; <strong>New Print Layout …</strong>.</li>
<li>Give it a name, e.g.&nbsp;<code>crime_asb</code>.</li>
<li>A new window opens up. In the toolbar on the left hand side, click on the <strong>Add map</strong> button: <br><br></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/add_map.png" class="img-fluid figure-img" width="36"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Draw a box on the canvas. The crime map should now appear.</li>
<li>Using the toolbar on the left hand side, there is several other options such as <strong>Add scale bar</strong>, <strong>Add North Arrow</strong>, and <strong>Add Legend</strong>. <em>There are lots of options to play around with!</em></li>
<li>Once you are happy with your map, you can save your map by going to <strong>Layout</strong> &gt; <strong>Export as Image …</strong>. If you get a message popping up saying something about “Project Contains WMS Layers” just click on <strong>Close</strong>. Navigate to your <em>working directory</em>, give your map a name and click <strong>Save</strong>. Also click <strong>Save</strong> on the next window that pops up.</li>
</ul>
<p>These steps should create an image which you should be able to find in your <em>working directory</em>. The <strong>GIF</strong> below summarises these steps:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-export-map" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/export_map.gif" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;21: Finalising a map in the <strong>Print Layout</strong> and saving a map as an image. <a href="https://jtvandijk.github.io/GEOG0014/images/export_map.gif" target="_blank">[Enlarge image]</a></figcaption>
</figure>
</div>
</div>
</div>
<p>This image is now ready to be used outside QGIS.</p>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The map that we have created now requires some TLC on the styling front. There are many more options on how to style the maps, so do play around with colours and settings when making your maps. Have a look at the QGIS tutorial on <a href="https://docs.qgis.org/3.28/en/docs/training_manual/map_composer/map_composer.html">Using the Print Layout</a> and QGIS manual on <a href="https://docs.qgis.org/3.28/en/docs/user_manual/print_composer/index.html">Laying out maps</a>.</p>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./01-data-prep.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Data preparation</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./03-worksheet.html" class="pagination-link">
        <span class="nav-page-text">Worksheet</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">Course material by <a href="https://www.mappingdutchman.com">Justin van Dijk</a>. Available under <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>.</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>